---
dist: trusty
sudo: required

env:
  - image: naftulikay/travis-vm:latest

matrix:
  fast_finish: true

services:
  - docker

before_install:
  - docker build -t ${image} ./

install: true

script:
  - container_id_file=$(mktemp)
  - docker run --detach ${image} > ${container_id_file}
  - docker exec --tty "$(cat ${container_id_file})" env TERM=xterm echo "Hello from Docker VM."

notifications:
  email:
    on_success: never
    on_failure: never
  webhooks: https://registry.hub.docker.com/u/naftulikay/trusty-vm/trigger/${DOCKERHUB_TOKEN}/
